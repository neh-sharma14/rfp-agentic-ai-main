# Proposal Outline Crew - Phase 1 Output Documentation

This document describes the Phase 1 output files automatically generated by the Proposal Outline Crew.

## Phase 1 Output Files

The Phase 1 crew automatically saves its results to JSON files in this directory:

### File Naming Convention

- **Default**: `phase1_result.json`
- **With unique_id**: `phase1_result_{unique_id}.json`

### File Behavior

- **Always Overwrites**: Files are replaced each time to ensure latest results
- **UTF-8 Encoding**: Proper encoding for international characters
- **Pretty JSON**: Indented format for readability
- **Error Handling**: Failed attempts are also saved with error details

## Phase 1 Output Structure

### Successful Analysis Result

```json
{
  "sections": [
    {
      "id": "string",
      "title": "string",
      "subsections": [
        {
          "id": "string",
          "title": "string",
          "page_limits": {
            "min_pages": "number",
            "max_pages": "number"
          },
          "evaluation_mapping": [
            {
              "criteria": "string",
              "weight": "number",
              "source": "string"
            }
          ]
        }
      ],
      "page_limits": {
        "min_pages": "number",
        "max_pages": "number"
      },
      "evaluation_mapping": [
        {
          "criteria": "string",
          "weight": "number",
          "source": "string"
        }
      ]
    }
  ],
  "processing_metadata": {
    "rfp_title": "string",
    "total_sections": "number",
    "total_subsections": "number",
    "agency_format": "string",
    "document_source": "string",
    "analysis_date": "ISO timestamp"
  },
  "metadata": {
    "timestamp": "Unix timestamp in milliseconds",
    "unique_id": "string or null",
    "file_path": "absolute path to saved file",
    "phase": "Phase 1 - RFP Structure Analysis"
  }
}
```

### Error Result Structure

```json
{
  "error": "string describing the error",
  "raw_content": "string - original content if parsing failed",
  "parse_error": "string - specific JSON parse error if applicable",
  "last_error": "string - last error message if retries failed",
  "inputs": {
    "original_input_parameters": "object"
  },
  "metadata": {
    "timestamp": "Unix timestamp in milliseconds",
    "unique_id": "string or null",
    "file_path": "absolute path to saved file",
    "phase": "Phase 1 - RFP Structure Analysis"
  }
}
```

## Key Features of Phase 1

### RFP Structure Analysis

- **Section Discovery**: Identifies all mandatory proposal sections
- **Subsection Mapping**: Discovers required subsections within each section
- **Page Limit Extraction**: Captures page limits and formatting requirements
- **Evaluation Criteria Mapping**: Links sections to evaluation criteria with weights

### Federal Compliance Focus

- **Section L Processing**: Extracts instructions to offerors
- **Section M Analysis**: Identifies evaluation criteria and weights
- **SOW/PWS Integration**: Processes statement of work requirements
- **FAR/DFARS Compliance**: Ensures federal acquisition regulation compliance

### Agency Format Support

- **NASA SEWP**: Space and Earth Science contracts
- **GSA Schedule**: General Services Administration formats
- **NIH CIO-SP**: National Institutes of Health formats
- **Generic Federal**: Standard government contract formats

## Usage Examples

### Running Phase 1 Only

```python
from src.proposal_outline_crew.crew import kickoff_phase1_crew

# Basic usage
inputs = {
    "rfp_document": "path/to/rfp.pdf",
    "unique_id": "RFP_2024_001"
}

result = await kickoff_phase1_crew(inputs)
```

### Input Parameters

- **`rfp_document`** (required): Path to the RFP document
- **`unique_id`** (optional): Unique identifier for file naming
- **`win_themes`** (optional): Array of win themes for strategic alignment
- **`agency_type`** (optional): Specific agency format hint

### Output File Location

Files are saved in: `src/proposal_outline_crew/`

## Error Handling

The Phase 1 crew includes robust error handling:

### Retry Logic

- **3 Attempts**: Automatic retry for transient failures
- **Progressive Delay**: Intelligent retry spacing
- **Error Preservation**: All errors saved for troubleshooting

### Graceful Degradation

- **Default Values**: Fallback values for missing data
- **Partial Results**: Saves partial analysis if possible
- **Error Documentation**: Detailed error messages in output files

### Common Error Scenarios

1. **JSON Parse Errors**: Raw content preserved for manual review
2. **Network Timeouts**: Retry logic handles transient issues
3. **Document Access Errors**: Clear error messages with troubleshooting hints
4. **OpenSearch Connection Issues**: Fallback processing when possible

## File Management Tips

### Multiple Concurrent Runs

- Use unique `unique_id` values to prevent file conflicts
- Files with different unique_ids can coexist

### Troubleshooting

- Check the `metadata.timestamp` to verify file freshness
- Review `error` and `parse_error` fields for debugging
- Examine `raw_content` for manual analysis if parsing fails

### Integration

- Files can be directly loaded and processed by Phase 2
- JSON structure is compatible with downstream analysis tools
- Metadata enables audit trails and version tracking

## Dependencies

- **CrewAI Framework**: Multi-agent orchestration
- **OpenSearch**: Document vectorization and search
- **OpenAI**: Language model processing
- **AWS Services**: Cloud integration for hosted deployments

---

_This documentation is automatically updated with each Phase 1 execution. Check the timestamp in generated files for the latest analysis results._
